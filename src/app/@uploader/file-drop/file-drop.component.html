<div>
    <h3>Upload Files</h3>
    <div class="block">
        <div ngfDrop [(validDrag)]="baseDropValid" multiple="1" selectable="1" (fileOver)="hasBaseDropZoneOver=$event"
            [(files)]="files" [accept]="accept" [maxSize]="maxSize" [(dragFiles)]="dragFiles"
            [(lastInvalids)]="lastInvalids" class="well my-drop-zone" [class.invalid-drag]="baseDropValid===false"
            [class.valid-drag]="baseDropValid" (filesChange)="lastFileAt=getDate()"
            [fileDropDisabled]="fileDropDisabled">
            Drop your files here
        </div>
    </div>

    <div style="margin-bottom: 40px">
        <h3>{{ files.length }} Queued Files</h3>
        <table class="table">
            <thead>
                <tr>
                    <th></th>
                    <th>Preview</th>
                    <th>Name</th>
                    <th>Size</th>
                    <th>Progress</th>
                </tr>
            </thead>
            <tbody>
                <tr *ngFor="let item of files;let i=index">
                    <td nowrap>
                        <button type="button" class="btn btn-danger btn-xs" (click)="files.splice(i,1)">
                            <span class="fa fa-minus"></span>
                        </button>
                    </td>
                    <td *ngIf="['image/gif','image/png','image/jpeg'].indexOf(item.type)>=0; else elseBlock">
                        <div class="previewIcon" [ngfBackground]="item"></div>
                    </td>
                    <ng-template #elseBlock>
                        <td></td>
                    </ng-template>
                    <td>
                        <strong>{{ item.name }}</strong>
                    </td>
                    <td nowrap>
                        {{ item.size/1024/1024 | number:'.2' }} MB
                    </td>
                    <td>
                        <mat-progress-bar *ngIf="progress" mode="determinate"
                            [value]="progress[item.name].progress | async">
                        </mat-progress-bar>
                    </td>
                </tr>
            </tbody>
        </table>

        <div>
            <ng-container *ngIf="lastFileAt">
                <p>
                    <strong>Last file(s) selected At:</strong> {{ lastFileAt | date : 'longTime' }}
                </p>
            </ng-container>
            <ng-container *ngIf="progress==100">
                <i class="glyphicon glyphicon-ok"></i>
                &nbsp;Upload Complete
            </ng-container>
            <button type="button" class="btn btn-success btn-s" (click)="uploadFiles()" [disabled]="!files.length">
                <span class="glyphicon glyphicon-upload"></span> Upload all
            </button>
            <button type="button" class="btn btn-warning btn-s" (click)="cancel()" [disabled]="!httpEmitter">
                <span class="glyphicon glyphicon-ban-circle"></span> Cancel all
            </button>
            <button type="button" class="btn btn-danger btn-s" (click)="files.length=0" [disabled]="!files.length">
                <span class="glyphicon glyphicon-trash"></span> Remove all
            </button>
        </div>
    </div>
</div>